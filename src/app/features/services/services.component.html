<section id="services" class="py-20 bg-white">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-4">
        {{ translate('services.title') }}
      </h2>
      <div class="w-24 h-1 bg-gradient-to-r from-primary-600 to-secondary-600 mx-auto mb-8"></div>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">
        {{ translate('services.description') }}
      </p>
    </div>

    <!-- Services Grid - Desktop: Pirámide Invertida, Mobile: Carousel -->
    <div class="mb-16">
      <!-- Mobile Carousel -->
      <div *ngIf="isMobile()" class="carousel-container relative">
        <div 
          class="carousel-wrapper overflow-hidden"
          (touchstart)="onTouchStart($event)"
          (touchend)="onTouchEnd($event)"
        >
          <div 
            class="carousel-track flex transition-transform duration-300 ease-in-out"
            [style.transform]="getCarouselTransform()"
          >
            <div 
              *ngFor="let service of services; let i = index"
              class="carousel-slide w-full flex-shrink-0 px-4"
            >
              <div 
                class="group cursor-pointer flex relative"
                (click)="toggleServiceDetails(service.id)"
              >
                <!-- Service Card Content -->
                <div 
                  [class]="getServiceCardClass(service.id)"
                  [attr.data-service-id]="service.id"
                  class="bg-white rounded-2xl p-8 shadow-lg transition-all duration-300 border-2 w-full flex flex-col"
                >
                  <!-- Main Content -->
                  <div class="flex-grow">
                    <!-- Service Icon & Title -->
                    <div class="text-center mb-6">
                      <div 
                        [class]="getIconClass(service.id)"
                        class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center text-2xl transition-all duration-300"
                      >
                        {{ service.icon }}
                      </div>
                      <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ translate(service.title) }}</h3>
                      <p class="text-gray-600 leading-relaxed text-sm">{{ translate(service.description) }}</p>
                    </div>

                    <!-- Service Features -->
                    <div class="space-y-3 mb-6">
                      <!-- Always show first 3 features -->
                      <div 
                        *ngFor="let feature of service.features.slice(0, 3)" 
                        class="flex items-center space-x-3"
                      >
                        <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                          <span class="text-primary-600 text-xs">✓</span>
                        </div>
                        <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                      </div>
                      
                      <!-- Show additional features when expanded -->
                      <div 
                        *ngIf="expandedService() === service.id"
                        class="space-y-3 animate-fade-in"
                      >
                        <div 
                          *ngFor="let feature of service.features.slice(3)" 
                          class="flex items-center space-x-3"
                        >
                          <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="text-primary-600 text-xs">✓</span>
                          </div>
                          <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                        </div>
                      </div>
                      
                      <!-- Show "more features" text only when not expanded and has more than 3 -->
                      <div 
                        *ngIf="expandedService() !== service.id && service.features.length > 3"
                        class="text-primary-600 text-sm font-medium text-center"
                      >
                        +{{ service.features.length - 3 }} {{ translate('services.moreFeatures') }}
                      </div>
                    </div>
                  </div>

                  <!-- CTA Button - Always at bottom -->
                  <div class="mt-auto">
                    <app-button
                      variant="primary"
                      [fullWidth]="true"
                      (clicked)="selectService(service)"
                    >
                      <span class="mr-2">💬</span>
                      {{ translate('services.consultQuote') }}
                    </app-button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Carousel Indicators/Bullets -->
        <div class="flex justify-center mt-6 space-x-2">
          <button
            *ngFor="let service of services; let i = index"
            (click)="goToSlide(i)"
            class="w-3 h-3 rounded-full transition-all duration-200"
            [class.bg-primary-600]="currentSlide() === i"
            [class.bg-gray-300]="currentSlide() !== i"
            [class.scale-125]="currentSlide() === i"
          ></button>
        </div>
      </div>

      <!-- Desktop Grid -->
      <div *ngIf="!isMobile()">
        <!-- Primera fila: primeros 3 servicios -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
        <div 
          *ngFor="let service of services.slice(0, 3); let i = index"
          class="group cursor-pointer flex relative"
          (click)="toggleServiceDetails(service.id)"
          (mouseenter)="setHoveredService(service.id)"
          (mouseleave)="setHoveredService(null)"
        >
          <!-- Placeholder invisible cuando está expandida para mantener el espacio -->
          <div 
            *ngIf="expandedService() === service.id"
            class="bg-transparent w-full flex flex-col"
            style="min-height: 384px"
          ></div>
          
          <!-- Tarjeta real -->
          <div 
            [class]="getServiceCardClass(service.id)"
            [attr.data-service-id]="service.id"
            class="bg-white rounded-2xl p-8 shadow-lg transition-all duration-300 border-2 w-full flex flex-col"
            [class.absolute]="expandedService() === service.id"
            [class.top-0]="expandedService() === service.id"
            [class.left-0]="expandedService() === service.id"
            [class.relative]="expandedService() !== service.id"
          >
          <!-- Main Content -->
          <div class="flex-grow">
            <!-- Service Icon & Title -->
            <div class="text-center mb-6">
              <div 
                [class]="getIconClass(service.id)"
                class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center text-2xl transition-all duration-300"
              >
                {{ service.icon }}
              </div>
              <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ translate(service.title) }}</h3>
              <p class="text-gray-600 leading-relaxed text-sm">{{ translate(service.description) }}</p>
            </div>

            <!-- Service Features -->
            <div class="space-y-3 mb-6">
              <!-- Always show first 3 features -->
              <div 
                *ngFor="let feature of service.features.slice(0, 3)" 
                class="flex items-center space-x-3"
              >
                <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                  <span class="text-primary-600 text-xs">✓</span>
                </div>
                <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
              </div>
              
              <!-- Show additional features when expanded -->
              <div 
                *ngIf="expandedService() === service.id"
                class="space-y-3 animate-fade-in"
              >
                <div 
                  *ngFor="let feature of service.features.slice(3)" 
                  class="flex items-center space-x-3"
                >
                  <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-primary-600 text-xs">✓</span>
                  </div>
                  <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                </div>
              </div>
              
              <!-- Show "more features" text only when not expanded and has more than 3 -->
              <div 
                *ngIf="expandedService() !== service.id && service.features.length > 3"
                class="text-primary-600 text-sm font-medium text-center"
              >
                +{{ service.features.length - 3 }} {{ translate('services.moreFeatures') }}
              </div>
            </div>
          </div>

          <!-- CTA Button - Always at bottom -->
          <div class="mt-auto">
            <app-button
              variant="primary"
              [fullWidth]="true"
              (clicked)="selectService(service)"
            >
              <span class="mr-2">💬</span>
              {{ translate('services.consultQuote') }}
            </app-button>
          </div>


        </div>
        </div>
      </div>

      <!-- Segunda fila: últimos 2 servicios centrados -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-8">
        
        <!-- Primer servicio de la segunda fila: columnas 2-3 -->
        <div 
          *ngIf="services[3]" 
          class="group cursor-pointer lg:col-span-2 lg:col-start-2 flex relative"
          (click)="toggleServiceDetails(services[3].id)"
          (mouseenter)="setHoveredService(services[3].id)"
          (mouseleave)="setHoveredService(null)"
        >
          <!-- Placeholder invisible cuando está expandida para mantener el espacio -->
          <div 
            *ngIf="expandedService() === services[3].id"
            class="bg-transparent w-full flex flex-col"
            style="min-height: 384px"
          ></div>
          
          <!-- Tarjeta real -->
          <div 
            [class]="getServiceCardClass(services[3].id)"
            [attr.data-service-id]="services[3].id"
            class="bg-white rounded-2xl p-8 shadow-lg transition-all duration-300 border-2 w-full flex flex-col"
            [class.absolute]="expandedService() === services[3].id"
            [class.top-0]="expandedService() === services[3].id"
            [class.left-0]="expandedService() === services[3].id"
            [class.relative]="expandedService() !== services[3].id"
          >
            <!-- Main Content -->
            <div class="flex-grow">
              <!-- Service Icon & Title -->
              <div class="text-center mb-6">
                <div 
                  [class]="getIconClass(services[3].id)"
                  class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center text-2xl transition-all duration-300"
                >
                  {{ services[3].icon }}
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ translate(services[3].title) }}</h3>
                <p class="text-gray-600 leading-relaxed text-sm">{{ translate(services[3].description) }}</p>
              </div>

              <!-- Service Features -->
              <div class="space-y-3 mb-6">
                <!-- Always show first 3 features -->
                <div 
                  *ngFor="let feature of services[3].features.slice(0, 3)" 
                  class="flex items-center space-x-3"
                >
                  <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-primary-600 text-xs">✓</span>
                  </div>
                  <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                </div>
                
                <!-- Show additional features when expanded -->
                <div 
                  *ngIf="expandedService() === services[3].id"
                  class="space-y-3 animate-fade-in"
                >
                  <div 
                    *ngFor="let feature of services[3].features.slice(3)" 
                    class="flex items-center space-x-3"
                  >
                    <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                      <span class="text-primary-600 text-xs">✓</span>
                    </div>
                    <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                  </div>
                </div>
                
                <!-- Show "more features" text only when not expanded and has more than 3 -->
                <div 
                  *ngIf="expandedService() !== services[3].id && services[3].features.length > 3"
                  class="text-primary-600 text-sm font-medium text-center"
                >
                  +{{ services[3].features.length - 3 }} {{ translate('services.moreFeatures') }}
                </div>
              </div>
            </div>

            <!-- CTA Button - Always at bottom -->
            <div class="mt-auto">
              <app-button
                variant="primary"
                [fullWidth]="true"
                (clicked)="selectService(services[3])"
              >
                <span class="mr-2">💬</span>
                {{ translate('services.consultQuote') }}
              </app-button>
            </div>


          </div>
        </div>
        
        <!-- Segundo servicio de la segunda fila: columnas 4-5 -->
        <div 
          *ngIf="services[4]" 
          class="group cursor-pointer lg:col-span-2 lg:col-start-4 flex relative"
          (click)="toggleServiceDetails(services[4].id)"
          (mouseenter)="setHoveredService(services[4].id)"
          (mouseleave)="setHoveredService(null)"
        >
          <!-- Placeholder invisible cuando está expandida para mantener el espacio -->
          <div 
            *ngIf="expandedService() === services[4].id"
            class="bg-transparent w-full flex flex-col"
            style="min-height: 384px"
          ></div>
          
          <!-- Tarjeta real -->
          <div 
            [class]="getServiceCardClass(services[4].id)"
            [attr.data-service-id]="services[4].id"
            class="bg-white rounded-2xl p-8 shadow-lg transition-all duration-300 border-2 w-full flex flex-col"
            [class.absolute]="expandedService() === services[4].id"
            [class.top-0]="expandedService() === services[4].id"
            [class.left-0]="expandedService() === services[4].id"
            [class.relative]="expandedService() !== services[4].id"
          >
            <!-- Main Content -->
            <div class="flex-grow">
              <!-- Service Icon & Title -->
              <div class="text-center mb-6">
                <div 
                  [class]="getIconClass(services[4].id)"
                  class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center text-2xl transition-all duration-300"
                >
                  {{ services[4].icon }}
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ translate(services[4].title) }}</h3>
                <p class="text-gray-600 leading-relaxed text-sm">{{ translate(services[4].description) }}</p>
              </div>

              <!-- Service Features -->
              <div class="space-y-3 mb-6">
                <!-- Always show first 3 features -->
                <div 
                  *ngFor="let feature of services[4].features.slice(0, 3)" 
                  class="flex items-center space-x-3"
                >
                  <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-primary-600 text-xs">✓</span>
                  </div>
                  <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                </div>
                
                <!-- Show additional features when expanded -->
                <div 
                  *ngIf="expandedService() === services[4].id"
                  class="space-y-3 animate-fade-in"
                >
                  <div 
                    *ngFor="let feature of services[4].features.slice(3)" 
                    class="flex items-center space-x-3"
                  >
                    <div class="w-5 h-5 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                      <span class="text-primary-600 text-xs">✓</span>
                    </div>
                    <span class="text-gray-700 text-sm">{{ translate(feature) }}</span>
                  </div>
                </div>
                
                <!-- Show "more features" text only when not expanded and has more than 3 -->
                <div 
                  *ngIf="expandedService() !== services[4].id && services[4].features.length > 3"
                  class="text-primary-600 text-sm font-medium text-center"
                >
                  +{{ services[4].features.length - 3 }} {{ translate('services.moreFeatures') }}
                </div>
              </div>
            </div>

            <!-- CTA Button - Always at bottom -->
            <div class="mt-auto">
              <app-button
                variant="primary"
                [fullWidth]="true"
                (clicked)="selectService(services[4])"
              >
                <span class="mr-2">💬</span>
                {{ translate('services.consultQuote') }}
              </app-button>
            </div>


          </div>
        </div>
      </div>
      </div> <!-- Close desktop grid wrapper -->
    </div>

    <!-- Service Plans -->
    <div class="bg-gray-50 rounded-3xl p-8 lg:p-12">
      <div class="text-center mb-12">
        <h3 class="text-3xl font-bold text-gray-900 mb-4">Planes de Servicio</h3>
        <p class="text-lg text-gray-600">
          Elige el plan que mejor se adapte a tus necesidades y presupuesto
        </p>
      </div>

      <div class="grid lg:grid-cols-3 gap-8">
        <div 
          *ngFor="let plan of servicePlans"
          [class]="getPlanCardClass(plan)"
          class="relative bg-white rounded-2xl p-8 transition-all duration-300"
        >
          <!-- Popular badge -->
          <div 
            *ngIf="plan.popular" 
            class="absolute -top-4 left-1/2 transform -translate-x-1/2"
          >
            <div class="bg-gradient-to-r from-primary-600 to-secondary-600 text-white px-4 py-2 rounded-full text-sm font-medium">
              ⭐ Más Popular
            </div>
          </div>

          <div class="text-center mb-8">
            <h4 class="text-2xl font-bold text-gray-900 mb-2">{{ plan.name }}</h4>
            <div class="text-4xl font-bold text-primary-600 mb-2">{{ plan.price }}</div>
            <div class="text-gray-600">{{ plan.duration }}</div>
            <p class="text-gray-600 mt-4">{{ plan.description }}</p>
          </div>

          <div class="space-y-4 mb-8">
            <div 
              *ngFor="let feature of plan.features"
              class="flex items-center space-x-3"
            >
              <div class="w-5 h-5 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-green-600 text-xs">✓</span>
              </div>
              <span class="text-gray-700">{{ feature }}</span>
            </div>
          </div>

          <app-button
            [variant]="plan.popular ? 'primary' : 'outline'"
            [fullWidth]="true"
            size="lg"
            (clicked)="selectPlan(plan)"
          >
            <span class="mr-2">🚀</span>
            Elegir Plan
          </app-button>
        </div>
      </div>
    </div>

    <!-- Process Section -->
    <div class="mt-16">
      <div class="text-center mb-12">
        <h3 class="text-3xl font-bold text-gray-900 mb-4">Mi Proceso de Trabajo</h3>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Una metodología probada que garantiza resultados excepcionales
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div 
          *ngFor="let step of processSteps; let i = index"
          class="text-center group"
        >
          <div class="relative mb-6">
            <div class="w-20 h-20 bg-gradient-to-r from-primary-600 to-secondary-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
              <span class="text-white text-2xl">{{ step.icon }}</span>
            </div>
            <div class="absolute -top-2 -right-2 w-8 h-8 bg-white border-4 border-primary-600 rounded-full flex items-center justify-center font-bold text-primary-600">
              {{ i + 1 }}
            </div>
          </div>
          
          <h4 class="text-xl font-bold text-gray-900 mb-3">{{ step.title }}</h4>
          <p class="text-gray-600 leading-relaxed">{{ step.description }}</p>
        </div>
      </div>
    </div>

    <!-- Contact CTA -->
    <div class="mt-16 text-center">
      <div class="bg-gradient-to-r from-primary-600 to-secondary-600 rounded-3xl p-8 lg:p-12 text-white">
        <h3 class="text-3xl font-bold mb-4">{{ translate('services.readyToStart') }}</h3>
        <p class="text-xl mb-8 opacity-90 max-w-2xl mx-auto">
          {{ translate('services.letsCreateTogether') }}
        </p>
        <app-button
          variant="secondary"
          size="lg"
          (clicked)="startConversation()"
          class="bg-white text-primary-600 hover:bg-gray-50"
        >
          <span class="mr-2">💬</span>
          {{ translate('services.startConversation') }}
        </app-button>
      </div>
    </div>
  </div>
</section>
